---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { Github, ExternalLink, ArrowLeft, Clock, Calendar } from 'lucide-solid';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: project,
  }));
}

const project = Astro.props;
const { Content } = await project.render();

const tagColors: Record<string, string> = {
  'React': '#61dafb',
  'TypeScript': '#3178c6',
  'Next.js': '#000000',
  'Node.js': '#339933',
  'Python': '#3776ab',
  'Rust': '#dea584',
  'AI/ML': '#ff6b6b',
  'Web': '#4ecdc4',
  'Mobile': '#a855f7',
  'Database': '#f59e0b',
  'SolidJS': '#4f88c6',
  'Astro': '#ff5d01',
  'Tailwind': '#38bdf8',
};
---

<Layout title={`${project.data.title} | Projects`}>
  
  <main class="pt-32 pb-16 px-4">
    <article class="max-w-6xl mx-auto">
      <!-- Back Button -->
      <a 
        href="/projects" 
        class="inline-flex items-center gap-2 text-[var(--muted-foreground)] hover:text-[var(--foreground)] mb-8 transition-colors"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
        Back to Projects
      </a>
      
      <!-- Header -->
      <header class="mb-8">
        <h1 class="text-4xl font-bold mb-4">{project.data.title}</h1>
        <p class="text-xl text-[var(--muted-foreground)] mb-6">{project.data.description}</p>
        
        <!-- Meta Info -->
        <div class="flex flex-wrap items-center gap-4 mb-6">
          {project.data.createdAt && (
            <span class="flex items-center gap-2 text-[var(--muted-foreground)]">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
              {new Date(project.data.createdAt).toLocaleDateString('en-US', {
                month: 'long',
                day: 'numeric',
                year: 'numeric',
              })}
            </span>
          )}
        </div>
        
        <!-- Tags -->
        <div class="flex flex-wrap gap-2 mb-6">
          {project.data.tags.map((tag) => (
            <span
              class="tag text-sm font-semibold"
              style={{
                'background-color': `${tagColors[tag.name] || tag.color}20`,
                'color': tagColors[tag.name] || tag.color,
                'border': `1px solid ${tagColors[tag.name] || tag.color}40`,
              }}
            >
              {tag.name}
            </span>
          ))}
        </div>
        
        <!-- Action Buttons -->
        <div class="flex gap-4">
          {project.data.githubUrl && (
            <a
              href={project.data.githubUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 px-4 py-2 neu-flat rounded-lg font-medium hover:opacity-80 transition-opacity"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
              View Code
            </a>
          )}
          {project.data.demoUrl && (
            <a
              href={project.data.demoUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 px-4 py-2 neu-flat rounded-lg font-medium hover:opacity-80 transition-opacity"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>
              Live Demo
            </a>
          )}
        </div>
      </header>
      
      <!-- Cover Image -->
      {project.data.coverImage && (
        <img
          src={project.data.coverImage}
          alt={project.data.title}
          class="w-full rounded-xl mb-8"
        />
      )}
      
      <!-- Video -->
      {project.data.videoUrl && (
        <div class="mb-8 rounded-xl overflow-hidden neu-flat p-4">
          <iframe
            src={project.data.videoUrl}
            class="w-full aspect-video rounded-lg"
            frameborder="0"
            allowfullscreen
          ></iframe>
        </div>
      )}
      
      <!-- Content -->
      <div class="neu-flat p-8 rounded-2xl">
        <div class="prose max-w-none">
          <Content />
        </div>
      </div>
    </article>
  </main>
</Layout>

<style>
  .prose h1 {
    font-size: 2rem;
    font-weight: 700;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }
  .prose h2 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }
  .prose h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 1.25rem;
    margin-bottom: 0.5rem;
  }
  .prose p {
    margin-bottom: 1rem;
    line-height: 1.75;
  }
  .prose ul, .prose ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }
  .prose li {
    margin-bottom: 0.5rem;
  }
  .prose code {
    background: var(--muted);
    padding: 0.25rem 0.5rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
  }
  .prose pre {
    background: var(--muted);
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1rem 0;
  }
  .prose pre code {
    background: transparent;
    padding: 0;
  }
  .prose blockquote {
    border-left: 4px solid var(--foreground);
    padding-left: 1rem;
    margin-left: 0;
    font-style: italic;
    color: var(--muted-foreground);
  }
  .prose img {
    border-radius: 0.75rem;
    margin: 1.5rem 0;
  }
  .prose table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }
  .prose th, .prose td {
    border: 1px solid var(--border);
    padding: 0.75rem;
    text-align: left;
  }
  .prose th {
    background: var(--muted);
    font-weight: 600;
  }
  .prose a {
    color: var(--foreground);
    text-decoration: underline;
  }
  .prose hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 2rem 0;
  }
</style>