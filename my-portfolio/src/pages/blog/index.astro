---
import Layout from '../../layouts/Layout.astro';
import { Navigation } from '../../components/Navigation';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
---

<Layout title="Blog | My Portfolio">
  <Navigation client:load />
  
  <main class="pt-24 pb-16 px-4">
    <div class="max-w-6xl mx-auto">
      <h1 class="text-3xl font-bold mb-8">Blog</h1>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {posts.map((post) => (
          <a 
            href={`/blog/${post.slug}`} 
            class="project-card neu-convex overflow-hidden cursor-pointer block"
          >
            {post.data.coverImage && (
              <div class="relative aspect-[2/1] bg-[var(--muted)] overflow-hidden">
                <img
                  src={post.data.coverImage}
                  alt={post.data.title}
                  class="w-full h-full object-cover"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent" />
              </div>
            )}
            
            <div class="p-6">
              <span
                class="inline-block px-3 py-1 text-xs font-semibold rounded-full mb-3"
                style={{
                  'background-color': `${post.data.category.color}20`,
                  'color': post.data.category.color,
                  'border': `1px solid ${post.data.category.color}40`,
                }}
              >
                {post.data.category.name}
              </span>
              
              <h3 class="text-xl font-bold mb-2">{post.data.title}</h3>
              
              <p class="text-[var(--muted-foreground)] mb-4 line-clamp-2">
                {post.data.description}
              </p>
              
              <div class="flex items-center gap-4 text-sm text-[var(--muted-foreground)]">
                <span class="flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                  {new Date(post.data.publishedAt).toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric',
                  })}
                </span>
                {post.data.readingTime && (
                  <span class="flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    {post.data.readingTime} min read
                  </span>
                )}
              </div>
            </div>
          </a>
        ))}
      </div>
    </div>
  </main>
</Layout>
